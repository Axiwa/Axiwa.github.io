<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>LU分解、Chelosky分解、QR分解 | Azure</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="花式解决$Ax = b$">
    <meta name="generator" content="Hugo 0.111.3">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    
    
    
      

    

    
    
    <meta property="og:title" content="LU分解、Chelosky分解、QR分解" />
<meta property="og:description" content="花式解决$Ax = b$" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/posts/cla/" /><meta property="article:section" content="posts" />


<meta itemprop="name" content="LU分解、Chelosky分解、QR分解">
<meta itemprop="description" content="花式解决$Ax = b$">

<meta itemprop="wordCount" content="753">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="LU分解、Chelosky分解、QR分解"/>
<meta name="twitter:description" content="花式解决$Ax = b$"/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Azure
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        POSTS
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">LU分解、Chelosky分解、QR分解</h1>
      
      
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>花式解决$Ax = b$</p>
<p><a href="https://courses.engr.illinois.edu/cs357/sp2020">LU Decomposition for Solving Linear Equations</a></p>
<p><a href="https://www.cnblogs.com/bigmonkey/p/9555710.html">线性代数笔记10——矩阵的LU分解</a></p>
<p><a href="https://www.math.pku.edu.cn/teachers/lidf/docs/statcomp/html/_statcompbook/matrix-solve.html">线性方程组求解与LU分解</a></p>
<h2 id="gauss-elimination">Gauss Elimination</h2>
<p>Suppose we have a set of linear equations:
$$
\begin{bmatrix}
a_{11} &amp; a_{12} &amp; .. &amp; a_{1n} \
a_{21} &amp; a_{22} &amp; .. &amp; .. \
.. &amp;  &amp;  &amp;  \
&amp;  &amp;  &amp; a_{nn} \
\end{bmatrix}\begin{bmatrix}
x_1\
x_2\
..\
x_n
\end{bmatrix}
= \begin{bmatrix}
b_1\
b_2\
..\
b_n
\end{bmatrix}
$$</p>
<p>The most brute force way is to eliminate one variable each row from top to bottom, and then plug in the sovled variable to previous ones from bottom to top. It is something like this:</p>
<p>Step 1: Let each row except 1st do not contain $x_1$. Then eliminate $x_2$ in each row except 1st and 2nd</p>
<p>$$
\begin{bmatrix}
a_{11} &amp; a_{12} &amp; .. &amp; a_{1n} \
0 &amp; a_{22}-a_{12}\frac{a_{21}}{a_{11}} &amp; .. &amp; .. \
.. &amp;  &amp;  &amp;  \
0 &amp;  &amp;  &amp; a_{nn}-a_{1n}\frac{a_{n1}}{a_{11}} \
\end{bmatrix}\begin{bmatrix}
x_1\
x_2\
..\
x_n
\end{bmatrix}
= \begin{bmatrix}
b_1\
b_2-b_1\frac{a_{21}}{a_{11}}\
..\
b_n-b_1\frac{a_{n1}}{a_{11}}
\end{bmatrix}
$$</p>
<p>$$
\begin{bmatrix}
a_{11} &amp; a_{12} &amp; .. &amp; a_{1n} \
0 &amp; a_{22}-a_{12}\frac{a_{21}}{a_{11}} &amp; .. &amp; .. \
0 &amp; 0 &amp; a_{33}-a_{13}\frac{a_{31}}{a_{11}}-(a_{23}-a_{13}\frac{a_{21}}{a_{11}})\frac{a_{32}-a_{12}\frac{a_{31}}{a_{11}}}{a_{22}-a_{12}\frac{a_{21}}{a_{11}}} &amp;  \
.. &amp; .. &amp;  &amp;  \
0 &amp; 0 &amp;  &amp; a_{nn}-a_{1n}\frac{a_{n1}}{a_{11}}-(a_{2n}-a_{1n}\frac{a_{21}}{a_{11}})\frac{a_{n2}-a_{12}\frac{a_{n1}}{a_{11}}}{a_{22}-a_{12}\frac{a_{21}}{a_{11}}} \
\end{bmatrix}\begin{bmatrix}
x_1\
x_2\
..\
x_n
\end{bmatrix}
$$
$$
= \begin{bmatrix}
b_1\
b_2-b_1\frac{a_{21}}{a_{11}}\
..\
b_n-b_1\frac{a_{n1}}{a_{11}}-(b_2-b_1\frac{a_{21}}{a_{11}})\frac{a_{n2}-a_{12}\frac{a_{n1}}{a_{11}}}{a_{22}-a_{12}\frac{a_{21}}{a_{11}}}
\end{bmatrix}
$$</p>
<p>If every time the denominator is not zero, finally we will get an upper matrix
$$
\begin{bmatrix}
u_{11} &amp; u_{12} &amp; .. &amp; u_{1n} \
0 &amp; u_{22} &amp; .. &amp; .. \
.. &amp;  &amp;  &amp;  \
0 &amp;  &amp;  &amp; u_{nn} \
\end{bmatrix}\begin{bmatrix}
x_1\
x_2\
..\
x_n
\end{bmatrix}
= \begin{bmatrix}
\widetilde{b_1}\
\widetilde{b_2}\
..\
\widetilde{b_n}
\end{bmatrix}
$$</p>
<p>This process can be seen as</p>
<p>$$
\begin{aligned}
E_1Ax = E_1b \
E_2E_1Ax = E_2E_1b\
\cdots \
E_n..E_1Ax = E_n&hellip;E_1b = Ux\
(E_n&hellip;E_1)^{-1}Ux = b \
LUx = b
\end{aligned}
$$</p>
<p>where $E_i$</p>
<p>$$
E_1 = \begin{bmatrix}
1 &amp; 0 &amp; &hellip;&amp;0\
-\frac{a_{21}}{a_{11}} &amp; 1 &amp; &hellip;&amp;0 \
-\frac{a_{31}}{a_{11}}&amp;0&amp;1&hellip;&amp;0\
&hellip;\
-\frac{a_{n1}}{a_{11}}&amp;..&amp;&amp;1
\end{bmatrix}
$$</p>
<p>$$
E_2 = \begin{bmatrix}
1 &amp; 0 &amp; &hellip;&amp;0\
0 &amp; 1 &amp; &hellip;&amp;0 \
0&amp; -\frac{a_{32}-a_{12} \frac{a_{31}}{a_{11}}}{a_{22}-a_{12} \frac{a_{21}}{a_{11}}}  &amp;1&hellip;&amp;0\
&hellip;\
0&amp;-\frac{a_{n 2}-a_{12} \frac{a_{n 1}}{a_{11}}}{a_{22}-a_{12} \frac{a_{21}}{a_{11}}}&amp;&amp;1
\end{bmatrix}
$$</p>
<p>&hellip;</p>
<p>are lower triangular matrix that eliminates the element in one column. The inverse of a lower triangular matrix is still lower triangular matrix, so A can be decomposed as $A = LU$ where $L$ is a lower triangular matrix and $U$ is an upper triangular matrix. However, what if in this process an element on the diagonal (for example at row i) is zero? We are sure that there would be a row (row &gt; i) that has non-zero at col i (otherwise A is not invertable). We then exchange this two rows using a perturbation matrix $P_i$ that reorders the rows of A.</p>
<p>$$
&hellip;E_iP(i, s_i)&hellip;A = &hellip;E_iP(i, s_i)&hellip;b
$$</p>
<p>For every row, we can exchange two rows using $P_i$ such that the current row i has the largest absolute value of i th column element. This is called &ldquo;Pivoting&rdquo;. It can be proved(<a href="https://link.zhihu.com/?target=https%3A//www.amazon.com/Numerical-Linear-Algebra-Lloyd-Trefethen/dp/0898713617">https://link.zhihu.com/?target=https%3A//www.amazon.com/Numerical-Linear-Algebra-Lloyd-Trefethen/dp/0898713617</a>) that</p>
<p>$$
PA = LU
$$</p>
<p>where</p>
<p>$$
P=P\left(n-1, s_{n-1}\right) \ldots P\left(2, s_{2}\right) P\left(1, s_{1}\right)
$$</p>
<p>The first step uses $2n(n-1)$ operations (multiplication + addition = 2 floating-point operations), the second uses $2(n-1)(n-2)$&hellip; so Step 1 uses ~ $O(2n^3/3)$</p>
<p>Step 2:</p>
<p>Now we can solve $x_n$ using $u_{nn}x_n = \widetilde{b_n}$. Then we plug $x_n$ to the second last row we can solve $x_{n-1}$, and so on&hellip; by back substitution we can solve $Ub = \widetilde{b}$ in $O(n^2)$</p>
<h2 id="lu-decomposition">LU decomposition</h2>
<p>We have seen that an invertable matrix A can be decomposed to $(P^{T})LU$. How can we get $P, L, U$?</p>
<h3 id="by-gauss-elimination">By Gauss elimination</h3>
<p>From Gauss elimination we know
$$
L = E^{-1}_1E^{-1}_2&hellip;E^{-1}_n
$$</p>
<p>And we can get $L$ by multiplication and inverse of these lower triangular matrices. Note that for lower triangular matrices $E_i$ with diagnal element 1, the inverse and multiplication is quite simple, and we can build $L$ with $E_i$(<a href="https://zhuanlan.zhihu.com/p/84210687">https://zhuanlan.zhihu.com/p/84210687</a>). Thus the complexity of LU decomposition and solve this linear equation is</p>
<ol>
<li>
<p>LU decomposition: $2n^2/3$</p>
</li>
<li>
<p>Solve $Ly = b$: $n^2$</p>
</li>
<li>
<p>Solve $Ux = y$: $n^2$</p>
</li>
</ol>
<p>We use LU decomposition but not Gauss elimination because we don&rsquo;t want to bother to modify $b$ every time, especially when we have many different $b$</p>
<h3 id="by-recursion">By recursion</h3>
<p>???</p>
<h2 id="lup-decomposition">LUP decomposition</h2>
<p>Every time we left-multiply a perturbation matrix $P$ and get</p>
<p>$$
E_{n-1} P_{n-1} \ldots E_{2} P_{2} E_{1} P_{1} A=U
$$
=&gt;
$$
PA = LU,\text { where } P=\prod_{i=1}^{n-1} P_{i}
$$</p>
<p>Though swapping two rows each time, the complexity is still $O(2n^3/3)$ (我觉得好像是这样&hellip;最多多出来$O(n^2)$次操作&hellip;)</p>
<h3 id="by-recursion-1">By recursion</h3><ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://example.org/" >
    &copy;  Azure 2023 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
